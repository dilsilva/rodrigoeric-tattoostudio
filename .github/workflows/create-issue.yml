name: Create Issue from Contact Form

on:
  repository_dispatch:
    types: [contact-form-submission]

jobs:
  create-issue:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      contents: read
    steps:
      - name: Create GitHub Issue
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            // Get the payload from the repository_dispatch event
            const payload = github.context.payload.client_payload;
            const { name, email, message } = payload;
            
            const issueTitle = `New Tattoo Inquiry from ${name}`;
            const issueBody = `## Contact Information
**Name:** ${name}
**Email:** ${email}

## Tattoo Idea
${message}

---
*Submitted via website contact form*`;

            const { data } = await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: issueTitle,
              body: issueBody,
              labels: ['inquiry', 'contact-form']
            });

            console.log(`Created issue #${data.number}: ${data.html_url}`);
